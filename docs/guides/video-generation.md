# Video Generation

## Basic usage

```python
from tarash.tarash_gateway import generate_video
from tarash.tarash_gateway.models import VideoGenerationConfig, VideoGenerationRequest

config = VideoGenerationConfig(
    provider="fal",
    model="fal-ai/veo3",
    # api_key omitted — reads FAL_KEY env var automatically
)
request = VideoGenerationRequest(
    prompt="A drone shot over mountain peaks at golden hour",
    duration_seconds=5,
    aspect_ratio="16:9",
    resolution="1080p",
)
response = generate_video(config, request)
print(response.video)
print(response.status)          # "completed"
print(response.duration)        # actual duration in seconds
```

## Config parameters

| Parameter | Type | Required | Default | Description |
|---|---|:---:|---|---|
| `provider` | `str` | ✅ | — | Provider ID: `"fal"`, `"openai"`, `"runway"`, `"google"`, `"replicate"` |
| `model` | `str` | ✅ | — | Model ID, e.g. `"fal-ai/veo3"`, `"openai/sora-2"` |
| `api_key` | `str \| None` | — | `None` | API key; omit to auto-read provider env var |
| `base_url` | `str \| None` | — | `None` | Override the provider's base API URL |
| `api_version` | `str \| None` | — | `None` | API version string (required for Azure OpenAI) |
| `timeout` | `int` | — | `600` | Max seconds to wait for generation to complete |
| `max_poll_attempts` | `int` | — | `120` | Max polling iterations before timeout |
| `poll_interval` | `int` | — | `5` | Seconds between status polls |
| `mock` | `MockConfig \| None` | — | `None` | Enable mock generation for testing |
| `fallback_configs` | `list[VideoGenerationConfig] \| None` | — | `None` | Ordered fallback provider chain |
| `provider_config` | `dict` | — | `{}` | Provider-specific config (e.g. GCP project for Google Vertex AI) |

## Request parameters

| Parameter | Type | Default | Description |
|---|---|---|---|
| `prompt` | `str` | required | Text description of the video |
| `duration_seconds` | `float \| None` | `None` | Requested duration (provider may round) |
| `resolution` | `str \| None` | `None` | e.g. `"1080p"`, `"720p"` |
| `aspect_ratio` | `str \| None` | `None` | e.g. `"16:9"`, `"9:16"`, `"1:1"` |
| `generate_audio` | `bool \| None` | `None` | Generate audio alongside video |
| `image_list` | `list[MediaType] \| None` | `None` | Reference images |
| `video` | `MediaType \| None` | `None` | Reference video for extend/remix |
| `seed` | `int \| None` | `None` | Reproducibility seed |
| `negative_prompt` | `str \| None` | `None` | What to avoid in the output |
| `enhance_prompt` | `bool \| None` | `None` | Let provider enhance your prompt |
| `extra_params` | `dict` | `{}` | Provider-specific parameters |

## Extra parameters

Pass provider-specific parameters that aren't in the standard interface via `extra_params`,
or simply as keyword arguments on `VideoGenerationRequest` — they are captured automatically:

```python
request = VideoGenerationRequest(
    prompt="A cyberpunk city at night",
    # Kling-specific parameter — captured into extra_params automatically
    cfg_scale=0.5,
)
```

## Response fields

```python
response = generate_video(config, request)

response.request_id          # unique ID for this generation
response.video           # URL to download/stream the video
response.status              # "completed"
response.duration            # actual video duration in seconds
response.resolution          # actual resolution
response.aspect_ratio        # actual aspect ratio
response.is_mock             # True if generated by MockProvider
response.execution_metadata  # timing, attempts, fallbacks used
```

## Provider-specific models

Set `model` on the config to target a specific model:

```python
config = VideoGenerationConfig(
    provider="fal",
    api_key="YOUR_KEY",
    model="fal-ai/kling-video/v2.1/standard/text-to-video",
)
```

## Accessing the raw response

Every response preserves the original, unmodified provider payload:

```python
response = generate_video(config, request)

# Full provider JSON — useful for debugging or accessing provider-specific fields
print(response.raw_response)

# Additional provider fields not in the standard interface
print(response.provider_metadata)

# Example: extract a provider-specific field
fal_request_id = response.raw_response.get("request_id")
```

`raw_response` is always populated. Use it when you need a field that isn't in
the standard `VideoGenerationResponse` interface.

See the [API reference](../api-reference/gateway.md) for the full function signature.
