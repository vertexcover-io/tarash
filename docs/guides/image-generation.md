# Image Generation

## Basic usage

```python
from tarash.tarash_gateway import generate_image
from tarash.tarash_gateway.models import ImageGenerationConfig, ImageGenerationRequest

config = ImageGenerationConfig(provider="openai", api_key="YOUR_KEY")
request = ImageGenerationRequest(
    prompt="A futuristic cityscape at dusk, photorealistic",
    size="1024x1024",
    quality="hd",
)
response = generate_image(config, request)
print(response.images[0])   # base64 or URL depending on provider
```

## Config parameters

| Parameter | Type | Required | Default | Description |
|---|---|:---:|---|---|
| `provider` | `str` | ✅ | — | Provider ID: `"openai"`, `"fal"`, `"stability"`, `"google"` |
| `model` | `str` | ✅ | — | Model ID, e.g. `"dall-e-3"`, `"fal-ai/flux-pro"` |
| `api_key` | `str \| None` | — | `None` | API key; omit to auto-read provider env var |
| `base_url` | `str \| None` | — | `None` | Override the provider's base API URL |
| `api_version` | `str \| None` | — | `None` | API version string (required for Azure OpenAI) |
| `timeout` | `int` | — | `120` | Max seconds to wait for generation |
| `max_poll_attempts` | `int` | — | `60` | Max polling iterations |
| `poll_interval` | `int` | — | `2` | Seconds between status polls |
| `mock` | `MockConfig \| None` | — | `None` | Enable mock generation for testing |
| `fallback_configs` | `list[ImageGenerationConfig] \| None` | — | `None` | Ordered fallback provider chain |
| `provider_config` | `dict` | — | `{}` | Provider-specific config |

## Request parameters

| Parameter | Type | Default | Description |
|---|---|---|---|
| `prompt` | `str` | required | Text description of the image |
| `negative_prompt` | `str \| None` | `None` | What to avoid |
| `size` | `str \| None` | `None` | e.g. `"1024x1024"`, `"1792x1024"` |
| `quality` | `str \| None` | `None` | e.g. `"standard"`, `"hd"` |
| `style` | `str \| None` | `None` | e.g. `"vivid"`, `"natural"` |
| `n` | `int \| None` | `None` | Number of images to generate |
| `aspect_ratio` | `str \| None` | `None` | Alternative to size |
| `seed` | `int \| None` | `None` | Reproducibility seed |
| `image_list` | `list[MediaType] \| None` | `None` | Reference or input images |
| `mask_image` | `MediaType \| None` | `None` | Mask for inpainting |

## Response fields

```python
response.images          # list of base64 strings or URLs
response.revised_prompt  # prompt as revised by the provider (OpenAI)
response.status          # "completed"
response.is_mock         # True if generated by MockProvider
```

## Accessing the raw response

```python
response = generate_image(config, request)

# Full original provider response
print(response.raw_response)

# Extra provider fields not in the standard interface
print(response.provider_metadata)
```
